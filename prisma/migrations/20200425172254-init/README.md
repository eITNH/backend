# Migration `20200425172254-init`

This migration has been generated by Torben Ewert at 4/25/2020, 5:22:54 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `eITNH`.`Auth` (
    `activated` boolean NOT NULL DEFAULT false ,
    `email` varchar(191) NOT NULL  ,
    `id` int NOT NULL  AUTO_INCREMENT,
    `password` varchar(191) NOT NULL  ,
    `salt` varchar(191) NOT NULL  ,
    `userId` int  ,
    `username` varchar(191) NOT NULL  ,
    `verificationToken` varchar(191)   ,
    PRIMARY KEY (`id`)
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `eITNH`.`User` (
    `createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,
    `firstname` varchar(191) NOT NULL  ,
    `id` int NOT NULL  AUTO_INCREMENT,
    `image` varchar(191)   ,
    `lastname` varchar(191) NOT NULL  ,
    `studentId` varchar(191)   ,
    `type` ENUM('STUDENT', 'PROFESSOR') NOT NULL DEFAULT 'STUDENT' ,
    `updatedAt` datetime(3) NOT NULL  ,
    PRIMARY KEY (`id`)
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `eITNH`.`Course` (
    `createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,
    `description` varchar(191)   ,
    `end` datetime(3) NOT NULL  ,
    `id` int NOT NULL  AUTO_INCREMENT,
    `public` boolean NOT NULL DEFAULT false ,
    `start` datetime(3) NOT NULL  ,
    `studentId` int   ,
    `teaser` varchar(191)   ,
    `title` varchar(191) NOT NULL  ,
    `updatedAt` datetime(3) NOT NULL  ,
    `userId` int  ,
    PRIMARY KEY (`id`)
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `eITNH`.`Category` (
    `color` varchar(191) NOT NULL  ,
    `createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,
    `id` int NOT NULL  AUTO_INCREMENT,
    `title` varchar(191) NOT NULL  ,
    `type` ENUM('FILE', 'COURSE') NOT NULL  ,
    `updatedAt` datetime(3) NOT NULL  ,
    PRIMARY KEY (`id`)
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `eITNH`.`File` (
    `courseId` int NOT NULL ,
    `createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,
    `creatorId` int NOT NULL ,
    `description` varchar(191) NOT NULL  ,
    `id` int NOT NULL  AUTO_INCREMENT,
    `path` varchar(191) NOT NULL  ,
    `previewPath` varchar(191) NOT NULL  ,
    `size` int NOT NULL  ,
    `title` varchar(191) NOT NULL  ,
    `type` varchar(191) NOT NULL  ,
    `updatedAt` datetime(3) NOT NULL  ,
    PRIMARY KEY (`id`)
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `eITNH`.`_CourseRequests` (
    `A` int NOT NULL ,
    `B` int NOT NULL 
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `eITNH`.`_Courses` (
    `A` int NOT NULL ,
    `B` int NOT NULL 
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `eITNH`.`_CourseOffers` (
    `A` int NOT NULL ,
    `B` int NOT NULL 
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `eITNH`.`_CategoryToCourse` (
    `A` int NOT NULL ,
    `B` int NOT NULL 
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `eITNH`.`_CategoryToFile` (
    `A` int NOT NULL ,
    `B` int NOT NULL 
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE UNIQUE INDEX `Auth.username` ON `eITNH`.`Auth`(`username`)

CREATE UNIQUE INDEX `Auth.email` ON `eITNH`.`Auth`(`email`)

CREATE UNIQUE INDEX `Auth_userId` ON `eITNH`.`Auth`(`userId`)

CREATE UNIQUE INDEX `_CourseRequests_AB_unique` ON `eITNH`.`_CourseRequests`(`A`,`B`)

CREATE  INDEX `_CourseRequests_B_index` ON `eITNH`.`_CourseRequests`(`B`)

CREATE UNIQUE INDEX `_Courses_AB_unique` ON `eITNH`.`_Courses`(`A`,`B`)

CREATE  INDEX `_Courses_B_index` ON `eITNH`.`_Courses`(`B`)

CREATE UNIQUE INDEX `_CourseOffers_AB_unique` ON `eITNH`.`_CourseOffers`(`A`,`B`)

CREATE  INDEX `_CourseOffers_B_index` ON `eITNH`.`_CourseOffers`(`B`)

CREATE UNIQUE INDEX `_CategoryToCourse_AB_unique` ON `eITNH`.`_CategoryToCourse`(`A`,`B`)

CREATE  INDEX `_CategoryToCourse_B_index` ON `eITNH`.`_CategoryToCourse`(`B`)

CREATE UNIQUE INDEX `_CategoryToFile_AB_unique` ON `eITNH`.`_CategoryToFile`(`A`,`B`)

CREATE  INDEX `_CategoryToFile_B_index` ON `eITNH`.`_CategoryToFile`(`B`)

ALTER TABLE `eITNH`.`Auth` ADD FOREIGN KEY (`userId`) REFERENCES `eITNH`.`User`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `eITNH`.`Course` ADD FOREIGN KEY (`userId`) REFERENCES `eITNH`.`User`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `eITNH`.`File` ADD FOREIGN KEY (`courseId`) REFERENCES `eITNH`.`Course`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `eITNH`.`File` ADD FOREIGN KEY (`creatorId`) REFERENCES `eITNH`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `eITNH`.`_CourseRequests` ADD FOREIGN KEY (`A`) REFERENCES `eITNH`.`Course`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `eITNH`.`_CourseRequests` ADD FOREIGN KEY (`B`) REFERENCES `eITNH`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `eITNH`.`_Courses` ADD FOREIGN KEY (`A`) REFERENCES `eITNH`.`Course`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `eITNH`.`_Courses` ADD FOREIGN KEY (`B`) REFERENCES `eITNH`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `eITNH`.`_CourseOffers` ADD FOREIGN KEY (`A`) REFERENCES `eITNH`.`Course`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `eITNH`.`_CourseOffers` ADD FOREIGN KEY (`B`) REFERENCES `eITNH`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `eITNH`.`_CategoryToCourse` ADD FOREIGN KEY (`A`) REFERENCES `eITNH`.`Category`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `eITNH`.`_CategoryToCourse` ADD FOREIGN KEY (`B`) REFERENCES `eITNH`.`Course`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `eITNH`.`_CategoryToFile` ADD FOREIGN KEY (`A`) REFERENCES `eITNH`.`Category`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `eITNH`.`_CategoryToFile` ADD FOREIGN KEY (`B`) REFERENCES `eITNH`.`File`(`id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200425172254-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,98 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "mysql"
+  url      = "mysql://eITNH:ZYQhzOml73$7Iw$X@81.169.231.200/eITNH"
+}
+
+model Auth {
+  id                Int     @default(autoincrement()) @id
+  username          String  @unique
+  password          String
+  salt              String
+  email             String  @unique
+  activated         Boolean @default(false)
+  verificationToken String?
+  user              User?   @relation(fields: [userId], references: [id])
+  userId            Int?
+}
+
+// ============== USERS ==============
+model User {
+  id              Int      @default(autoincrement()) @id
+  firstname       String
+  lastname        String
+  image           String?
+  type            UserType @default(STUDENT)
+  studentId       String?
+  createdAt       DateTime @default(now())
+  updatedAt       DateTime @updatedAt
+  auth            Auth
+  courseRequests  Course[] @relation("CourseRequests", references: [id])
+  courses         Course[] @relation("Courses", references: [id])
+  favoriteCourses Course[]
+  courseOffers    Course[] @relation("CourseOffers", references: [id])
+  files           File[]
+}
+
+enum UserType {
+  STUDENT
+  PROFESSOR
+}
+
+// ============== COURSES ==============
+model Course {
+  id              Int        @default(autoincrement()) @id
+  title           String
+  teaser          String?
+  description     String?
+  start           DateTime
+  end             DateTime
+  public          Boolean    @default(false)
+  pendingMembers  User[]     @relation("CourseRequests", references: [id])
+  acceptedMembers User[]     @relation("Courses", references: [id])
+  professors      User[]     @relation("CourseOffers", references: [id])
+  files           File[]
+  categories      Category[] @relation(references: [id])
+  createdAt       DateTime   @default(now())
+  updatedAt       DateTime   @updatedAt
+  studentId       Int?
+  userId          Int?
+}
+
+// ============== CATEGORY ==============
+model Category {
+  id        Int          @default(autoincrement()) @id
+  title     String
+  color     String
+  type      CategoryType
+  courses   Course[]     @relation(references: [id])
+  files     File[]       @relation(references: [id])
+  createdAt DateTime     @default(now())
+  updatedAt DateTime     @updatedAt
+}
+
+enum CategoryType {
+  FILE
+  COURSE
+}
+
+// ============== FILES ==============
+model File {
+  id          Int        @default(autoincrement()) @id
+  title       String
+  course      Course     @relation(fields: [courseId], references: [id])
+  courseId    Int
+  type        String
+  size        Int
+  description String
+  previewPath String
+  path        String
+  creator     User       @relation(fields: [creatorId], references: [id])
+  creatorId   Int
+  categories  Category[] @relation(references: [id])
+  createdAt   DateTime   @default(now())
+  updatedAt   DateTime   @updatedAt
+}
```


